% !TEX root = ../../main.tex

% = = = 

\begin{Protocol*}[t!]
\begin{framed}
\footnotesize

% = = = 

$\prv$ private input: user identifiers, $\{\uid_1,\uid_2,\dots,\uid_\mu\}$, and user balances, $\{\bal_1,\bal_2,\dots,\bal_\mu\}$
\begin{enumerate}
    \item $\prv$ interpolates the identifier polynomial $u(X)$ such that $u(X_i)=\uid_i$ for $i$ from 1 to $\mu$.
    \item $\prv$ publishes commitment to $u(X)$.
    \item For check from user $i$, $\prv$ tells the user they at index $i$ and opens $u(i)$ and $p_1(i)$ (from \pol above).
\end{enumerate}

\textbf{Customer's input:} the commitments to the identifier polynomial $u(X)$ and the balance polynomial $p_1(X)$ and the witnesses at the corresponding points of $u(i)$ and $p_1(i)$
\begin{enumerate}
    \item $\vrf$ verifies that the two indexes $i$ are identical.
    \item $\vrf$ verifies their user identifier is the evaluation of $u$ at the given point $i$.
    \item $\vrf$ verifies their balance is the evaluation of $p_1$ at the given point $i$.
\end{enumerate}



% = = = 

\normalsize	
\end{framed}
\caption{The \userproof proof demonstrates that to each user who checks that their balance is recorded correctly under a unique identifier for them (to mitigate clash attacks).\label{alg:users}}
\end{Protocol*}