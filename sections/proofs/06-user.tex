% !TEX root = ../../main.tex

% = = = 

\begin{Protocol*}[t!]
\begin{mdframed}
\footnotesize

% = = = 

\begin{enumerate}
    \item $\prv$ interpolates the identifier polynomial $f_\mathsf{uid}(X)$ such that $f_\mathsf{uid}(X_i)=\uid_i$ for $i$ from 1 to $\mu$.
    \item $\prv$ publishes the commitments to $f_\mathsf{uid}(X)$ and $p_1$ (from \pol above).
    \item For check from user $i$, $\prv$ tells the user he is at index $i$ and opens $f_\mathsf{uid}(\omega^{i-1})$ and $p_1(\omega^{i-1})$.
    \item $\vrf$ outputs \textbf{acc} if and only if
    \begin{enumerate}
        \item His user identifier is the evaluation of $f_\mathsf{uid}$ at the given point $\omega^{i-1}$.
        \item His balance is the evaluation of $p_1$ at the given point $\omega^{i-1}$.
    \end{enumerate}
\end{enumerate}

% = = = 

\normalsize	
\end{mdframed}
\caption{The \userproof proof demonstrates that to each user who checks that their balance is recorded correctly under a unique identifier for them (to mitigate clash attacks).\label{alg:users}}
\end{Protocol*}
