\chapter{Security Analysis}
\label{sec:proof}

We adapt the security definition of a zero-knowledge proof of solvency from Provisions~\cite{provisions} in Appendix~\ref{app:defs}. We offer security proofs for \Sys and its sub-components: \bootstrap, \userproof, \pol, \poa, and \pos.

\section{Claims}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsection{The \bootstrap Argument}

\begin{theorem}
\label{thm:keys}
A $\Sigma$-protocol for relation $\mathrm{ZKPoK}\{(sk_i,s_i):[\mathsf{pk}_i=g^{\mathsf{sk}_i}\land{p_i}=\Comm{1,r_i}] \lor{p_i}=\Comm{0,r_i}\}$ exists which is complete, has special soundness and special HVZK. 
\end{theorem}

\begin{proof}
To demonstrate completeness, consult Protocol~\ref{alg:boot} (the inner framed protocol). \\
To demonstrate special soundness, let two accepting conversations between $\prv$ and $\vrf$
$$
(t_1,t_2,t_3,e,e_0,e_1,z_1,z_2,z_3),(t_1,t_2,t_3,e^\prime,e_0^\prime,e_1^\prime,z_1^\prime,z_2^\prime,z_3^\prime)\text{ with $e\ne{e^\prime}$}
$$
be given. It is obivious we can compute $sk_i,s_i$ such that the relation $\mathrm{ZKPoK}(sk_i,s_i)$ exists. Thus the $\Sigma$-protocol for the relation $\mathrm{ZKPoK}$ has special soundness. \\
Special HVZK is clear: given $e$ and randomly choose $e_0,e_1$ such that $e=e_1\oplus{e_2}$, let the simulator compute
$$
z_1\stackrel{\$}{\leftarrow}\mathbb{Z}_s,z_2\stackrel{\$}{\leftarrow}\mathbb{Z}_b,z_3\stackrel{\$}{\leftarrow}\mathbb{Z}_b,t_1=\gs^{z_1}/\mathsf{pk}_i^{e_0},t_2=\gb^{e_0}\hb^{z_2}/{p_i^{e_0}},t_3=\hb^{z_3}/{p_i^{e_1}}
$$
and output $(t_1,t_2,t_3,e,e_0,e_1,z_1,z_2,z_3)$. Clearly, the transcript is accepted by $\vrf$. Note $e$, $e_0$ and $e_1$ are random $t$-bit strings, which means they have the same distribution as the conversation between $\prv$ and $\vrf$. $z_1$, $z_2$, and $z_3$ are uniformly distributed over their corresponding fields; moreover, given $(e_1,e_2,z_1,z_2,z_3)$, $(t_1,t_2,t_3)$ are uniquely determined by the above equations. Therefore, the simuated transcript is not distinguishable from the real one to $\vrf$.
\end{proof}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =



% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\begin{restatable}{theorem}{nizkclaim}
\label{thm:nizkclaim}
A $\Sigma$-protocol for relation $\mathrm{ZKPoK} \{ (sk_i,s_i) :  [\mathsf{pk}_i=g^{\mathsf{sk}_i} \land p_i=\Comm{1,r_i}  ] \lor p_i=\Comm{0,r_i} \}$ exists which is a non-interactive zero knowledge proof (NIZKP).
\end{restatable}

\begin{proof}
Given the relation can proven with a ``standard'' $\Sigma$-protocol (per Thereom~\ref{thm:sigmaclaim}), we can use the well-known Fiat-Shamir heuristic to compile it to a NIZKP in the random oracle model. We do not repeat the proof for this (see~\cite{damgard10,sigma}) but stress that strong Fiat-Shamir~\cite{weakfs} needs to be used here and in the Poly-IOP components of \Sys, or practical attacks could be leveraged against the system (\cf~\cite{weakfsattacks}).\end{proof}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
